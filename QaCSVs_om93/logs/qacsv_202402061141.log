Feb 06 11:41:50 inf_ > Ininciando ejecución de: qacsv
~~~~ Queries a CSVs: construcción de archivos '.csv' según listado en: 'listas/CSVs_list_fsd010.xlsx' ~~~~
        --> LOG:  logs/qacsv_202402061141.log
Feb 06 11:41:51 ok_ > listas/CSVs_list_fsd010.xlsx leído correctamente:
   Periodo Carpeta Nombre archivo CSV             Server Base
0   202309     PDS             FSD010  172.31.119.50 Bantotal
Feb 06 11:41:51 ok_ > Fecha leída, Periodo: 202309.- Calculados; Fecha de corte: 20230930,
            Corte del mismo mes del año anterior: 20220930 
Feb 06 11:41:51 inf_ Conexiones a DB a establecer:
 ['172.31.119.50 Bantotal']
Feb 06 11:41:51 inf_  DB_ Conectando con: 172.31.119.50 Bantotal...
Feb 06 11:41:51 ok_ > DB_ Conexión con 172.31.119.50 Bantotal ESTABLECIDA! (1 _ * 172.31.119.50 Bantotal *)
Feb 06 11:41:51 inf_ Iniciando procesamiento de queries a 172.31.119.50 Bantotal - 1 queries
Feb 06 11:41:51 inf_ 1 _ < FSD010.csv > Iniciando armado archivo 'C:/MTM_PCE_FSD010/CVS_202309/PDS/FSD010.csv'
 Query:
select Pgcod,Aomod,Aosuc,Aomda,Aopap,Aocta,Aooper,Aosbop,Aotope,convert(datetime,Aofval,121) as Aofval,convert(datetime,Aofvto,121) as Aofvto,convert(float,Aopzo) as Aopzo,Aottas,convert(float,Aotasa) as Aotasa,Aotmor,convert(float,Aottac) as Aottac,Aotasc,Aotdia,Aotvto,Aotano,Aotint,Aodrev,convert(float,Aoimp) as Aoimp,Aopre,Aopre1,Aotcbi,convert(float,Aotcbi1) as Aotcbi1,Aoarb,Aoarb1,Aomd,Aomd1,Aonume,Aofnum,Aoafiv,Aocbcu,Aostat,Aoavis,Aoplus,Aoeven,convert(datetime,Aofe99,121) as Aofe99,Aocltcod,Aoperiod from fsd010 where aomod in (101,102,103,104) and aopzo>0 and aofval <=20230930 union
select Pgcod,Aomod,Aosuc,Aomda,Aopap,Aocta,Aooper,Aosbop,Aotope,convert(datetime,Aofval,121) as Aofval,convert(datetime,Aofvto,121) as Aofvto,convert(float,Aopzo) as Aopzo,Aottas,convert(float,Aotasa) as Aotasa,Aotmor,convert(float,Aottac) as Aottac,Aotasc,Aotdia,Aotvto,Aotano,Aotint,Aodrev,convert(float,Aoimp) as Aoimp,Aopre,Aopre1,Aotcbi,convert(float,Aotcbi1) as Aotcbi1,Aoarb,Aoarb1,Aomd,Aomd1,Aonume,Aofnum,Aoafiv,Aocbcu,Aostat,Aoavis,Aoplus,Aoeven,convert(datetime,Aofe99,121) as Aofe99,Aocltcod,Aoperiod from fsd010 where aomod in (71) and aofval <=20230930 
Feb 06 11:41:51 err_ 1 _ < FSD010.csv >ERROR en 10.d! Falló  Query a la DB
                ('22003', '[22003] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting expression to data type datetime. (8115) (SQLExecDirectW)')
Feb 06 11:41:51 ok_ >ok_ Se renombró listas/CSVs_list_fsd010.xlsx a listas/CSVs_list_fsd010_202402061141_err.xlsx
Feb 06 11:41:51 inf_   
                             --- RESUMEN  ---                              

Lista de CSVs a Procesar  ->  listas/CSVs_list_fsd010.xlsx                      
Archivo de LOGs           ->  logs/qacsv_202402061141.log                       
Lista CSVs Renombrada     ->  listas/CSVs_list_fsd010_202402061141_err.xlsx     

 Nro. de CSVs a Procesar   Nro. de CSVs Creados    Nro. de CSVs NO creados 
            1                        0                        1            

 Nro. de CSVs Procesados   Nro. de CSVs Creados   Nro. de CSVs con Error de Procesamiento
            1                        0                        1            

# Resultado de CSVs Procesados en Conexiones Exitosas a DBs:
 - Lista de CSVs con Error de Procesamiento (1):
   1 1 _ < FSD010.csv >

 - Lista de Errores de CSVs (1):
   1 1 _ < FSD010.csv >ERROR en 10.d! Falló  Query a la DB
                ('22003', '[22003] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting expression to data type datetime. (8115) (SQLExecDirectW)')

 - Lista de CSVs Creados (0):


# Resultado de Conexiones a DBs Consultadas:
 - Lista de conexiones a DB NO establecidas (0):

 - Lista de Errores de conexiones a DBs (0):

 - Lista de DBs Conectadas (1):
   1 1 _ * 172.31.119.50 Bantotal *


