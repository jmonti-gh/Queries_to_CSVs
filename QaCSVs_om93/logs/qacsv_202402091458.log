Feb 09 14:58:02 inf_ > Ininciando ejecución de: qacsv
~~~~ Queries a CSVs: construcción de archivos '.csv' según listado en: 'listas/CSVs_LGD_tarj_Coef_PD.xlsx' ~~~~
        --> LOG:  logs/qacsv_202402091458.log
Feb 09 14:58:03 ok_ > listas/CSVs_LGD_tarj_Coef_PD.xlsx leído correctamente:
    Periodo   Carpeta Nombre archivo CSV                  Server Base
0  202312.0  LGD_tarj        consum_mst1  172.16.1.12\MZ12 Mastercard
1       NaN       NaN        consum_mst2                          NaN
2       NaN       NaN           jmtcc027  172.16.1.12\MZ12 Mastercard
Feb 09 14:58:03 ok_ > Fecha leída, Periodo: 202312.- Calculados; Fecha de corte: '20231231',
            Corte del mismo mes del año anterior: '20221231' 
Feb 09 14:58:03 inf_ Conexiones a DB a establecer:
 ['172.16.1.12\\MZ12 Mastercard' '172.16.1.12\\MZ12 MPS_Cautivas'
 '172.31.119.50 Bantotal']
Feb 09 14:58:03 inf_  DB_ Conectando con: 172.16.1.12\MZ12 Mastercard...
Feb 09 14:58:03 ok_ > DB_ Conexión con 172.16.1.12\MZ12 Mastercard ESTABLECIDA! (1 _ * 172.16.1.12\MZ12 Mastercard *)
Feb 09 14:58:03 inf_ Iniciando procesamiento de queries a 172.16.1.12\MZ12 Mastercard - 4 queries
Feb 09 14:58:03 inf_ 1 _ < consum_mst1.csv > Iniciando armado archivo 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/consum_mst1.csv'
 Query:
select 
TipoRegistro, NroTarjeta, Entidad, Sucursal, NroCuenta, TipoSocio, DigitoVerific, GrupoCtaCte, NroComercio, NombreDelComercio, RamoComercio, CodMovimiento, NroCaja, NroTerminal,
NroLote, NroCupon, CantCuotas, CuotaVigente, MotContrapartida, CargoPorServicio, ConceptoAjuste, convert(datetime,FechaOperacion,121) as FechaOperacion, convert(datetime,FechaClearing,121) as FechaClearing, convert(datetime,FechaCtaCte,121) as FechaCtaCte, CodMoneda, CodMonedaOrigen, convert(float,IMonedaOrigen) as IMonedaOrigen,
convert(float,Itotal) as Itotal, convert(float,ISinDescto) as ISinDescto, convert(float,Ifinal) as Ifinal, TipoAjuste, AfectaSaldo,Aplicacion, convert(float,CprasMesAnt) as CprasMesAnt, TipoMovimiento, McaDebitoCredito
from mastercard..OpSocios where fechaOperacion>='20161001' and fechaOperacion<='20231231' and nrocuenta<=1500000 order by nrocuenta,FechaOperacion 
Feb 09 14:59:34 ok_ 1 _ < consum_mst1.csv > Creado exitosamente 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/consum_mst1.csv' 
Feb 09 14:59:34 inf_ 2 _ < consum_mst2.csv > Iniciando armado archivo 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/consum_mst2.csv'
 Query:
select 
TipoRegistro, NroTarjeta, Entidad, Sucursal, NroCuenta, TipoSocio, DigitoVerific, GrupoCtaCte, NroComercio, NombreDelComercio, RamoComercio, CodMovimiento, NroCaja, NroTerminal,
NroLote, NroCupon, CantCuotas, CuotaVigente, MotContrapartida, CargoPorServicio, ConceptoAjuste, convert(datetime,FechaOperacion,121) as FechaOperacion, convert(datetime,FechaClearing,121) as FechaClearing, convert(datetime,FechaCtaCte,121) as FechaCtaCte, CodMoneda, CodMonedaOrigen, convert(float,IMonedaOrigen) as IMonedaOrigen,
convert(float,Itotal) as Itotal, convert(float,ISinDescto) as ISinDescto, convert(float,Ifinal) as Ifinal, TipoAjuste, AfectaSaldo,Aplicacion, convert(float,CprasMesAnt) as CprasMesAnt, TipoMovimiento, McaDebitoCredito
from mastercard..OpSocios where fechaOperacion>='20161001' and fechaOperacion<='20231231' and nrocuenta>1500000 order by nrocuenta,FechaOperacion 
Feb 09 15:01:16 ok_ 2 _ < consum_mst2.csv > Creado exitosamente 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/consum_mst2.csv' 
Feb 09 15:01:16 inf_ 3 _ < jmtcc027.csv > Iniciando armado archivo 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/jmtcc027.csv'
 Query:
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from  jmt_cc027D where cod_concepto in (9100,9300,9900,9930,10000,10400) and anio=2016 and mes in (10,11,12) union
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from  jmt_cc027D where cod_concepto in (9100,9300,9900,9930,10000,10400) and anio>=2017 and anio<=2022 
union
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from  jmt_cc027D where cod_concepto in (9100,9300,9900,9930,10000,10400) and anio=2023 and mes in (1,2,3,4,5,6,7,8,9,10,11,12)
order by num_cta_socio,anio,mes 
Feb 09 15:01:38 ok_ 3 _ < jmtcc027.csv > Creado exitosamente 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/jmtcc027.csv' 
Feb 09 15:01:38 inf_ 4 _ < pago_mst1.csv > Iniciando armado archivo 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mst1.csv'
 Query:
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from mastercard..JMT_CC027D where anio=2016 and mes in (10,11,12) and cod_concepto in (16100) and nombre_archivo <>'temsmasg11.201911' union
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from mastercard..JMT_CC027D where anio=2016 and mes in (10,11,12) and cod_concepto in (3100) and nombre_archivo <>'temsmasg11.201911' and importe_pesos<=0 union
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from mastercard..JMT_CC027D where anio>=2017 and anio<=2022 and cod_concepto in (16100) and nombre_archivo <>'temsmasg11.201911' union
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from mastercard..JMT_CC027D where anio>=2017 and anio<=2022 and cod_concepto in (3100) and nombre_archivo <>'temsmasg11.201911' and importe_pesos<=0 union
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from mastercard..JMT_CC027D where anio=2023 and mes in (1,2,3,4,5,6,7,8,9,10,11,12) and cod_concepto in (16100) and nombre_archivo <>'temsmasg11.201911' union
select ANIO,MES,TIPO_REGISTRO,SUCURSAL,NUM_CTA_SOCIO,COD_CONCEPTO,CANTIDAD_PESOS,convert(float,IMPORTE_PESOS) as IMPORTE_PESOS,CANTIDAD_DOLAR,convert(float,IMPORTE_DOLAR) as IMPORTE_DOLAR,Nombre_Archivo from mastercard..JMT_CC027D where anio=2023 and mes in (1,2,3,4,5,6,7,8,9,10,11,12) and cod_concepto in (3100) and nombre_archivo <>'temsmasg11.201911' and importe_pesos<=0 
Feb 09 15:01:48 ok_ 4 _ < pago_mst1.csv > Creado exitosamente 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mst1.csv' 
Feb 09 15:01:48 inf_  DB_ Conectando con: 172.16.1.12\MZ12 MPS_Cautivas...
Feb 09 15:01:48 ok_ > DB_ Conexión con 172.16.1.12\MZ12 MPS_Cautivas ESTABLECIDA! (2 _ * 172.16.1.12\MZ12 MPS_Cautivas *)
Feb 09 15:01:48 inf_ Iniciando procesamiento de queries a 172.16.1.12\MZ12 MPS_Cautivas - 2 queries
Feb 09 15:01:48 inf_ 5 _ < pago_mtm1.csv > Iniciando armado archivo 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mtm1.csv'
 Query:
select cta_bto,tip_tar,nro_cta,convert(datetime,fec_com,121) as fec_com,nro_cup,ctd_cuo,cod_mov,convert(float,sum(imp_cuo)) as imp_cuo from mps_cautivas..movtrjpro_2016_10
where fec_com between '20180101' and '20231231' and cod_mov in (1,98) and tip_tar='PS' and nro_cta<=57845
group by cta_bto,tip_tar,nro_cta,fec_com,nro_cup,ctd_cuo,cod_mov
order by nro_cta,fec_com 
Feb 09 15:02:20 ok_ 5 _ < pago_mtm1.csv > Creado exitosamente 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mtm1.csv' 
Feb 09 15:02:20 inf_ 6 _ < pago_mtm2.csv > Iniciando armado archivo 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mtm2.csv'
 Query:
select cta_bto,tip_tar,nro_cta,convert(datetime,fec_com,121) as fec_com,nro_cup,ctd_cuo,cod_mov,convert(float,sum(imp_cuo)) as imp_cuo from mps_cautivas..movtrjpro_2016_10
where fec_com between '20180101' and '20231231' and cod_mov in (1,98) and tip_tar='PS' and nro_cta>57845
group by cta_bto,tip_tar,nro_cta,fec_com,nro_cup,ctd_cuo,cod_mov
order by nro_cta,fec_com 
Feb 09 15:02:51 ok_ 6 _ < pago_mtm2.csv > Creado exitosamente 'C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mtm2.csv' 
Feb 09 15:02:51 inf_  DB_ Conectando con: 172.31.119.50 Bantotal...
Feb 09 15:02:51 ok_ > DB_ Conexión con 172.31.119.50 Bantotal ESTABLECIDA! (3 _ * 172.31.119.50 Bantotal *)
Feb 09 15:02:51 inf_ Iniciando procesamiento de queries a 172.31.119.50 Bantotal - 1 queries
Feb 09 15:02:51 inf_ 7 _ < Operaciones con default.csv > Iniciando armado archivo 'C:/MTM_PCE_00/CVS_202312/Coef_PD/Operaciones con default.csv'
 Query:
select ri108emp as pgcod,ri108mod as MOD,ri108cta as CTA,ri108oper as OPER,RI108Sbop as SUBOP,convert(datetime,min(ri108fec),121) as FRI108_fec 
from fri108 where  ri108plazo>90 and ri108mod in (101,102,103,104) and ri108fec<='20231231'
group by ri108emp,ri108mod,ri108cta,ri108oper,RI108Sbop 
Feb 09 15:02:59 ok_ 7 _ < Operaciones con default.csv > Creado exitosamente 'C:/MTM_PCE_00/CVS_202312/Coef_PD/Operaciones con default.csv' 
Feb 09 15:02:59 ok_ >ok_ Se movió listas/CSVs_LGD_tarj_Coef_PD.xlsx a listas_hechas/CSVs_LGD_tarj_Coef_PD_202402091458.xlsx
Feb 09 15:02:59 inf_   
                             --- RESUMEN  ---                              

Lista de CSVs a Procesar  ->  listas/CSVs_LGD_tarj_Coef_PD.xlsx                 
Archivo de LOGs           ->  logs/qacsv_202402091458.log                       
Lista CSVs Renombrada     ->  listas_hechas/CSVs_LGD_tarj_Coef_PD_202402091458.xlsx

 Nro. de CSVs a Procesar   Nro. de CSVs Creados    Nro. de CSVs NO creados 
            7                        7                        0            

 Nro. de CSVs Procesados   Nro. de CSVs Creados   Nro. de CSVs con Error de Procesamiento
            7                        7                        0            

# Resultado de CSVs Procesados en Conexiones Exitosas a DBs:
 - Lista de CSVs con Error de Procesamiento (0):

 - Lista de Errores de CSVs (0):

 - Lista de CSVs Creados (7):
   1 1 _ < consum_mst1.csv > - C:/MTM_PCE_00/CVS_202312/LGD_tarj/consum_mst1.csv
   2 2 _ < consum_mst2.csv > - C:/MTM_PCE_00/CVS_202312/LGD_tarj/consum_mst2.csv
   3 3 _ < jmtcc027.csv > - C:/MTM_PCE_00/CVS_202312/LGD_tarj/jmtcc027.csv
   4 4 _ < pago_mst1.csv > - C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mst1.csv
   5 5 _ < pago_mtm1.csv > - C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mtm1.csv
   6 6 _ < pago_mtm2.csv > - C:/MTM_PCE_00/CVS_202312/LGD_tarj/pago_mtm2.csv
   7 7 _ < Operaciones con default.csv > - C:/MTM_PCE_00/CVS_202312/Coef_PD/Operaciones con default.csv


# Resultado de Conexiones a DBs Consultadas:
 - Lista de conexiones a DB NO establecidas (0):

 - Lista de Errores de conexiones a DBs (0):

 - Lista de DBs Conectadas (3):
   1 1 _ * 172.16.1.12\MZ12 Mastercard *
   2 2 _ * 172.16.1.12\MZ12 MPS_Cautivas *
   3 3 _ * 172.31.119.50 Bantotal *


